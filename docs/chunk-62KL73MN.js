import{a as J,b as y,c as we,d as Ne,e as Ae,f as Ve,g as Le,h as Fe,i as se,j as Oe,k as ke,l as Pe,m as Re}from"./chunk-7UBDATBV.js";import{a as ae,b as ve}from"./chunk-CKEY4INO.js";import{$a as G,C as s,D as c,Ga as F,H as f,Ha as O,Ia as k,J as m,Ja as P,Ka as R,La as j,Ma as U,N as n,O as i,Oa as ie,P as K,Pa as oe,Qa as re,S as E,Ta as W,U as b,V as v,Va as Me,W as V,X as o,Y as x,Ya as Be,Z as ee,Za as B,_ as te,a as Y,aa as I,ab as q,b as Se,ba as S,ca as C,cb as ye,db as z,ea as M,eb as je,fa as ne,ga as _,ha as D,i as Ce,j as Z,n as h,o as $,qa as T,ra as L,s as u,t as g,ta as De,v as _e,wa as Te}from"./chunk-ZM5FHFQ5.js";var qe=a=>["/budgets/update",a],ze=a=>["/budgets/clone",a],He=a=>["/budgets/expenses",a],Ke=a=>["/budgets/incomes",a],Je=a=>["/budgets/daily-expenses",a];function Qe(a,t){a&1&&(n(0,"div",5),o(1," No hay presupuestos disponibles. "),i())}function Xe(a,t){if(a&1){let e=E();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),_(9,"customCurrency"),i(),n(10,"td"),o(11),_(12,"customCurrency"),i(),n(13,"td"),o(14),_(15,"customCurrency"),i(),n(16,"td"),o(17),_(18,"customCurrency"),i(),n(19,"td"),o(20),_(21,"customCurrency"),i(),n(22,"td"),o(23),_(24,"customCurrency"),i(),n(25,"td")(26,"button",8),o(27," Editar "),i(),n(28,"button",9),b("click",function(){let d=u(e).$implicit,l=v(2);return g(l.confirmDelete(d.budgetId))}),o(29," Eliminar "),i(),n(30,"button",10),o(31," Clonar "),i(),n(32,"button",11),o(33," Ver Gastos "),i(),n(34,"button",11),o(35," Ver Ingresos "),i(),n(36,"button",11),o(37," Ver Gastos Diarios "),i()()()}if(a&2){let e=t.$implicit;s(2),x(e.description),s(2),x(e.month),s(2),x(e.year),s(2),x(D(9,14,e.totalIncome)),s(3),x(D(12,16,e.totalExpenses)),s(3),x(D(15,18,e.executed)),s(3),x(D(18,20,e.nonBudgetedExpenses)),s(3),x(D(21,22,e.pendingPayment)),s(3),x(D(24,24,e.shouldHave)),s(3),m("routerLink",M(26,qe,e.budgetId)),s(4),m("routerLink",M(28,ze,e.budgetId)),s(2),m("routerLink",M(30,He,e.budgetId)),s(2),m("routerLink",M(32,Ke,e.budgetId)),s(2),m("routerLink",M(34,Je,e.budgetId))}}function Ye(a,t){if(a&1&&(n(0,"table",6)(1,"thead")(2,"tr")(3,"th"),o(4,"Descripci\xF3n"),i(),n(5,"th"),o(6,"Mes"),i(),n(7,"th"),o(8,"A\xF1o"),i(),n(9,"th"),o(10,"Ingreso"),i(),n(11,"th"),o(12,"Gastos"),i(),n(13,"th"),o(14,"Realizado"),i(),n(15,"th"),o(16,"No presupuestado"),i(),n(17,"th"),o(18,"Pendiente"),i(),n(19,"th"),o(20,"Deber\xEDa tener"),i(),n(21,"th"),o(22,"Acciones"),i()()(),n(23,"tbody"),f(24,Xe,38,36,"tr",7),i()()),a&2){let e=v();s(24),m("ngForOf",e.budgets)}}var de=class a{constructor(t,e){this.budgetsService=t;this.authService=e}budgets=[];userId="";ngOnInit(){this.userId=this.authService.getUserIdFromToken(),this.userId?this.fetchBudgets():console.error("No se pudo obtener el usuario del token.","Error")}fetchBudgets(){this.userId&&this.budgetsService.getBudgetsByUser(this.userId).subscribe({next:t=>this.budgets=t,error:t=>console.error("Error al obtener presupuestos",t)})}confirmDelete(t){confirm("\xBFEst\xE1s seguro de que deseas eliminar este presupuesto?")&&this.deleteBudget(t)}deleteBudget(t){this.userId&&this.budgetsService.deleteBudget(this.userId,t).subscribe({next:()=>{alert("Presupuesto eliminado con \xE9xito"),this.fetchBudgets()},error:e=>{console.error("Error al eliminar el presupuesto",e),alert("Ocurri\xF3 un error al eliminar el presupuesto")}})}static \u0275fac=function(e){return new(e||a)(c(y),c(J))};static \u0275cmp=h({type:a,selectors:[["app-budgets-list"]],decls:8,vars:2,consts:[[1,"container","mt-4"],["class","alert alert-info",4,"ngIf"],[1,"d-flex","justify-content-end","mb-3"],["routerLink","/budgets/create",1,"btn","btn-success"],["class","table table-bordered mt-3",4,"ngIf"],[1,"alert","alert-info"],[1,"table","table-bordered","mt-3"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning","btn-sm",3,"routerLink"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"btn","btn-secondary","btn-sm",3,"routerLink"],[1,"btn","btn-info","btn-sm",3,"routerLink"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2"),o(2,"Gesti\xF3n de Presupuestos"),i(),f(3,Qe,2,0,"div",1),n(4,"div",2)(5,"button",3),o(6,"+ Crear Presupuesto"),i()(),f(7,Ye,25,1,"table",4),i()),e&2&&(s(3),m("ngIf",r.budgets.length===0),s(4),m("ngIf",r.budgets.length>0))},dependencies:[T,L,q,z],styles:[".container[_ngcontent-%COMP%]{max-width:98%;margin:0 auto}table[_ngcontent-%COMP%]{width:100%;text-align:left}"]})};var Ze=a=>["/budgets/expenses/add",a],$e=(a,t)=>["/budgets/expenses/update",a,t];function et(a,t){if(a&1){let e=E();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),_(9,"customCurrency"),i(),n(10,"td"),o(11),_(12,"customCurrency"),i(),n(13,"td"),o(14),_(15,"customCurrency"),i(),n(16,"td")(17,"button",5),o(18," Editar "),i(),n(19,"button",6),b("click",function(){let d=u(e).$implicit,l=v();return g(l.confirmDelete(d.expenseBudgetDetailId))}),o(20," Eliminar "),i()()()}if(a&2){let e=t.$implicit,r=v();s(2),x(e.customName),s(2),x(e.expenseTypeName),s(2),x(e.expenseTypeCategory),s(2),x(D(9,7,e.budgetedAmount)),s(3),x(D(12,9,e.amountPaid)),s(3),x(D(15,11,e.pendingPayment)),s(3),m("routerLink",ne(13,$e,r.budgetId,e.expenseBudgetDetailId))}}var pe=class a{constructor(t,e){this.route=t;this.budgetsService=e}expenses=[];budgetId=null;ngOnInit(){this.budgetId=this.route.snapshot.paramMap.get("budgetId"),this.budgetId&&this.fetchExpenses(this.budgetId)}fetchExpenses(t){this.budgetsService.getExpensesByBudget(t).subscribe({next:e=>this.expenses=e,error:e=>console.error("Error al obtener gastos",e)})}confirmDelete(t){confirm("\xBFEst\xE1s seguro de que deseas eliminar este gasto?")&&this.budgetId&&this.deleteExpense(this.budgetId,t)}deleteExpense(t,e){this.budgetsService.deleteExpense(t,e).subscribe({next:()=>{alert("Gasto eliminado con \xE9xito"),this.fetchExpenses(t)},error:r=>{console.error("Error al eliminar el gasto",r),alert("Ocurri\xF3 un error al eliminar el gasto")}})}static \u0275fac=function(e){return new(e||a)(c(B),c(y))};static \u0275cmp=h({type:a,selectors:[["app-expenses-list"]],decls:25,vars:4,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-end","mb-3"],[1,"btn","btn-success",3,"routerLink"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning","btn-sm",3,"routerLink"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2"),o(2,"Gastos del Presupuesto"),i(),n(3,"div",1)(4,"button",2),o(5," + Agregar Gasto "),i()(),n(6,"table",3)(7,"thead")(8,"tr")(9,"th"),o(10,"Nombre"),i(),n(11,"th"),o(12,"Tipo"),i(),n(13,"th"),o(14,"Categor\xEDa"),i(),n(15,"th"),o(16,"Presupuestado"),i(),n(17,"th"),o(18,"Pagado"),i(),n(19,"th"),o(20,"Pendiente"),i(),n(21,"th"),o(22,"Acciones"),i()()(),n(23,"tbody"),f(24,et,21,16,"tr",4),i()()()),e&2&&(s(4),m("routerLink",M(2,Ze,r.budgetId)),s(20),m("ngForOf",r.expenses))},dependencies:[T,q,z]})};function nt(a,t){a&1&&(n(0,"div",26),o(1," Por favor, seleccione un tipo de gasto. "),i())}function it(a,t){if(a&1){let e=E();n(0,"li",30),b("click",function(){let d=u(e).$implicit,l=v(2);return g(l.selectExpenseType(d))}),n(1,"span"),o(2),i(),K(3,"i",31),i()}if(a&2){let e=t.$implicit;s(2),x(e.name)}}function ot(a,t){if(a&1&&(n(0,"div")(1,"h6",27),o(2),i(),n(3,"ul",28),f(4,it,4,1,"li",29),i()()),a&2){let e=t.$implicit;s(2),x(e.key),s(2),m("ngForOf",e.value)}}var me=class a{constructor(t,e){this.budgetsService=t;this.expenseTypeService=e}budgetId=null;closeModal=new _e;expenseData={customName:"",expenseTypeId:null,budgetedAmount:0};expenseTypes=[];groupedExpenseTypes={};filteredExpenseTypes={};searchTerm="";selectedExpenseType=null;ngOnInit(){this.fetchExpenseTypes()}fetchExpenseTypes(){this.expenseTypeService.getExpenseTypes().subscribe({next:t=>{this.expenseTypes=t,this.groupExpenseTypes(),this.filterExpenseTypes()},error:t=>console.error("Error al obtener tipos de gastos",t)})}groupExpenseTypes(){this.groupedExpenseTypes=this.expenseTypes.reduce((t,e)=>(t[e.category]||(t[e.category]=[]),t[e.category].push(e),t),{})}filterExpenseTypes(){let t=this.searchTerm.toLowerCase(),e={};Object.keys(this.groupedExpenseTypes).forEach(r=>{let d=this.groupedExpenseTypes[r].filter(l=>l.name.toLowerCase().includes(t)||l.category.toLowerCase().includes(t));d.length>0&&(e[r]=d)}),this.filteredExpenseTypes=e}openExpenseTypeModal(){let t=document.getElementById("expenseTypeModal");t&&new ve(t,{backdrop:!1}).show()}selectExpenseType(t){this.selectedExpenseType=t,this.expenseData.expenseTypeId=t.id,this.closeModalById("expenseTypeModal")}closeModalById(t){let e=document.getElementById(t);e&&ve.getInstance(e)?.hide()}addExpense(){if(!this.budgetId)return;if(!this.expenseData.expenseTypeId){alert("Por favor, seleccione un tipo de gasto.");return}let t=Se(Y({},this.expenseData),{budgetId:this.budgetId});this.budgetsService.addExpense(t).subscribe({next:()=>{alert("Gasto agregado con \xE9xito"),this.closeModal.emit()},error:e=>{console.error("Error al agregar el gasto",e),alert("Ocurri\xF3 un error al agregar el gasto")}})}cancel(){this.closeModal.emit()}static \u0275fac=function(e){return new(e||a)(c(y),c(ae))};static \u0275cmp=h({type:a,selectors:[["app-add-expense"]],inputs:{budgetId:"budgetId"},outputs:{closeModal:"closeModal"},decls:40,vars:9,consts:[["expenseForm","ngForm"],[1,"container","mt-2"],[3,"ngSubmit"],[1,"mb-3"],["for","customName",1,"form-label"],["type","text","id","customName","name","customName","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","expenseTypeId",1,"form-label"],["type","button",1,"form-control","text-start",3,"click"],["class","text-danger mt-2",4,"ngIf"],["for","budgetedAmount",1,"form-label"],["type","number","id","budgetedAmount","name","budgetedAmount","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],["id","expenseTypeModal","tabindex","-1","aria-labelledby","expenseTypeModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],["id","expenseTypeModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["type","text","placeholder","Buscar tipo de gasto",1,"form-control",3,"ngModelChange","input","ngModel"],[2,"max-height","400px","overflow-y","auto"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"text-danger","mt-2"],[1,"text-secondary"],[1,"list-group","mb-3"],["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",3,"click"],[1,"bi","bi-check-circle","text-success"]],template:function(e,r){if(e&1){let d=E();n(0,"div",1)(1,"h4"),o(2,"Agregar Gasto"),i(),n(3,"form",2,0),b("ngSubmit",function(){return u(d),g(r.addExpense())}),n(5,"div",3)(6,"label",4),o(7,"Nombre del Gasto"),i(),n(8,"input",5),C("ngModelChange",function(p){return u(d),S(r.expenseData.customName,p)||(r.expenseData.customName=p),g(p)}),i()(),n(9,"div",3)(10,"label",6),o(11,"Tipo de Gasto"),i(),n(12,"button",7),b("click",function(){return u(d),g(r.openExpenseTypeModal())}),o(13),i(),f(14,nt,2,0,"div",8),i(),n(15,"div",3)(16,"label",9),o(17,"Monto Presupuestado"),i(),n(18,"input",10),C("ngModelChange",function(p){return u(d),S(r.expenseData.budgetedAmount,p)||(r.expenseData.budgetedAmount=p),g(p)}),i()(),n(19,"div",11)(20,"button",12),o(21," Agregar "),i(),n(22,"button",13),b("click",function(){return u(d),g(r.cancel())}),o(23," Cancelar "),i()()()(),n(24,"div",14)(25,"div",15)(26,"div",16)(27,"div",17)(28,"h5",18),o(29,"Seleccionar Tipo de Gasto"),i(),K(30,"button",19),i(),n(31,"div",20)(32,"div",3)(33,"input",21),C("ngModelChange",function(p){return u(d),S(r.searchTerm,p)||(r.searchTerm=p),g(p)}),b("input",function(){return u(d),g(r.filterExpenseTypes())}),i()(),n(34,"div",22),f(35,ot,5,2,"div",23),_(36,"keyvalue"),i()(),n(37,"div",24)(38,"button",25),o(39,"Cerrar"),i()()()()()}if(e&2){let d=V(4);s(8),I("ngModel",r.expenseData.customName),s(5),ee(" ",(r.selectedExpenseType==null?null:r.selectedExpenseType.name)||"Seleccionar Tipo de Gasto"," "),s(),m("ngIf",!r.expenseData.expenseTypeId&&d.submitted),s(4),I("ngModel",r.expenseData.budgetedAmount),s(2),m("disabled",!d.valid||!r.expenseData.expenseTypeId),s(13),I("ngModel",r.searchTerm),s(2),m("ngForOf",D(36,7,r.filteredExpenseTypes))}},dependencies:[T,L,j,F,U,O,k,W,R,P,De]})};function rt(a,t){if(a&1&&(n(0,"option",12),o(1),i()),a&2){let e=t.$implicit;m("value",e.id),s(),te(" ",e.name," (",e.category,") ")}}var le=class a{constructor(t,e,r,d){this.route=t;this.budgetsService=e;this.expenseTypeService=r;this.router=d}budgetId=null;expenseId=null;expenseData={customName:"",expenseTypeId:0,budgetedAmount:0};expenseTypes=[];ngOnInit(){this.budgetId=this.route.snapshot.paramMap.get("budgetId"),this.expenseId=Number(this.route.snapshot.paramMap.get("expenseId")),this.budgetId&&this.expenseId&&this.fetchExpenseData(this.budgetId,this.expenseId),this.fetchExpenseTypes()}fetchExpenseData(t,e){this.budgetsService.getExpensesByBudget(t).subscribe({next:r=>{let d=r.find(l=>l.expenseBudgetDetailId===e);d&&(this.expenseData={customName:d.customName,expenseTypeId:d.expenseTypeId,budgetedAmount:d.budgetedAmount})},error:r=>console.error("Error al obtener gasto",r)})}fetchExpenseTypes(){this.expenseTypeService.getExpenseTypes().subscribe({next:t=>this.expenseTypes=t,error:t=>console.error("Error al obtener tipos de gastos",t)})}updateExpense(){if(!this.budgetId||!this.expenseId)return;let t={budgetId:this.budgetId,expenseBudgetDetailId:this.expenseId,budgetedAmount:this.expenseData.budgetedAmount,customName:this.expenseData.customName,expenseTypeId:this.expenseData.expenseTypeId};this.budgetsService.updateExpense(t).subscribe({next:()=>{alert("Gasto actualizado con \xE9xito"),this.router.navigate([`/budgets/expenses/${this.budgetId}`])},error:e=>{console.error("Error al actualizar el gasto",e),alert("Ocurri\xF3 un error al actualizar el gasto")}})}static \u0275fac=function(e){return new(e||a)(c(B),c(y),c(ae),c(G))};static \u0275cmp=h({type:a,selectors:[["app-update-expense"]],decls:20,vars:5,consts:[["expenseForm","ngForm"],[1,"container","mt-4"],[3,"ngSubmit"],[1,"mb-3"],["for","customName",1,"form-label"],["type","text","id","customName","name","customName","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","expenseTypeId",1,"form-label"],["id","expenseTypeId","name","expenseTypeId","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","budgetedAmount",1,"form-label"],["type","number","id","budgetedAmount","name","budgetedAmount","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"value"]],template:function(e,r){if(e&1){let d=E();n(0,"div",1)(1,"h2"),o(2,"Actualizar Gasto"),i(),n(3,"form",2,0),b("ngSubmit",function(){return u(d),g(r.updateExpense())}),n(5,"div",3)(6,"label",4),o(7,"Nombre del Gasto"),i(),n(8,"input",5),C("ngModelChange",function(p){return u(d),S(r.expenseData.customName,p)||(r.expenseData.customName=p),g(p)}),i()(),n(9,"div",3)(10,"label",6),o(11,"Tipo de Gasto"),i(),n(12,"select",7),C("ngModelChange",function(p){return u(d),S(r.expenseData.expenseTypeId,p)||(r.expenseData.expenseTypeId=p),g(p)}),f(13,rt,2,3,"option",8),i()(),n(14,"div",3)(15,"label",9),o(16,"Monto Presupuestado"),i(),n(17,"input",10),C("ngModelChange",function(p){return u(d),S(r.expenseData.budgetedAmount,p)||(r.expenseData.budgetedAmount=p),g(p)}),i()(),n(18,"button",11),o(19," Actualizar Gasto "),i()()()}if(e&2){let d=V(4);s(8),I("ngModel",r.expenseData.customName),s(4),I("ngModel",r.expenseData.expenseTypeId),s(),m("ngForOf",r.expenseTypes),s(4),I("ngModel",r.expenseData.budgetedAmount),s(),m("disabled",!d.valid)}},dependencies:[T,j,oe,re,F,U,ie,O,k,W,R,P]})};var at=a=>["/budgets/incomes/add",a],st=(a,t)=>["/budgets/incomes/update",a,t];function dt(a,t){if(a&1){let e=E();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),_(5,"customCurrency"),i(),n(6,"td")(7,"button",5),o(8," Editar "),i(),n(9,"button",6),b("click",function(){let d=u(e).$implicit,l=v();return g(l.confirmDelete(d.incomeBudgetDetailId))}),o(10," Eliminar "),i()()()}if(a&2){let e=t.$implicit,r=v();s(2),x(e.name),s(2),x(D(5,3,e.amount)),s(3),m("routerLink",ne(5,st,r.budgetId,e.incomeBudgetDetailId))}}var ce=class a{constructor(t,e){this.route=t;this.budgetsService=e}incomes=[];budgetId=null;ngOnInit(){this.budgetId=this.route.snapshot.paramMap.get("budgetId"),this.budgetId&&this.fetchIncomes(this.budgetId)}fetchIncomes(t){this.budgetsService.getIncomesByBudget(t).subscribe({next:e=>this.incomes=e,error:e=>console.error("Error al obtener ingresos",e)})}confirmDelete(t){confirm("\xBFEst\xE1s seguro de que deseas eliminar este ingreso?")&&this.budgetId&&this.deleteIncome(this.budgetId,t)}deleteIncome(t,e){this.budgetsService.deleteIncome(t,e).subscribe({next:()=>{alert("Ingreso eliminado con \xE9xito"),this.fetchIncomes(t)},error:r=>{console.error("Error al eliminar el ingreso",r),alert("Ocurri\xF3 un error al eliminar el ingreso")}})}static \u0275fac=function(e){return new(e||a)(c(B),c(y))};static \u0275cmp=h({type:a,selectors:[["app-incomes-list"]],decls:17,vars:4,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-end","mb-3"],[1,"btn","btn-success",3,"routerLink"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning","btn-sm",3,"routerLink"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2"),o(2,"Ingresos del Presupuesto"),i(),n(3,"div",1)(4,"button",2),o(5," + Agregar Ingreso "),i()(),n(6,"table",3)(7,"thead")(8,"tr")(9,"th"),o(10,"Nombre"),i(),n(11,"th"),o(12,"Monto"),i(),n(13,"th"),o(14,"Acciones"),i()()(),n(15,"tbody"),f(16,dt,11,8,"tr",4),i()()()),e&2&&(s(4),m("routerLink",M(2,at,r.budgetId)),s(12),m("ngForOf",r.incomes))},dependencies:[T,q,z]})};var ue=class a{constructor(t,e,r){this.route=t;this.budgetsService=e;this.router=r}budgetId=null;incomeId=null;incomeData={name:"",amount:0};ngOnInit(){this.budgetId=this.route.snapshot.paramMap.get("budgetId"),this.incomeId=Number(this.route.snapshot.paramMap.get("incomeId")),this.budgetId&&this.incomeId&&this.fetchIncomeData(this.budgetId,this.incomeId)}fetchIncomeData(t,e){this.budgetsService.getIncomesByBudget(t).subscribe({next:r=>{let d=r.find(l=>l.incomeBudgetDetailId===e);d&&(this.incomeData={name:d.name,amount:d.amount})},error:r=>console.error("Error al obtener ingreso",r)})}updateIncome(){if(!this.budgetId||!this.incomeId)return;let t={name:this.incomeData.name,amount:this.incomeData.amount};this.budgetsService.updateIncome(this.budgetId,this.incomeId,t).subscribe({next:()=>{alert("Ingreso actualizado con \xE9xito"),this.router.navigate([`/budgets/incomes/${this.budgetId}`])},error:e=>{console.error("Error al actualizar ingreso",e),alert("Ocurri\xF3 un error al actualizar el ingreso")}})}static \u0275fac=function(e){return new(e||a)(c(B),c(y),c(G))};static \u0275cmp=h({type:a,selectors:[["app-update-income"]],decls:15,vars:3,consts:[["incomeForm","ngForm"],[1,"container","mt-4"],[3,"ngSubmit"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","amount",1,"form-label"],["type","number","id","amount","name","amount","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,r){if(e&1){let d=E();n(0,"div",1)(1,"h2"),o(2,"Actualizar Ingreso"),i(),n(3,"form",2,0),b("ngSubmit",function(){return u(d),g(r.updateIncome())}),n(5,"div",3)(6,"label",4),o(7,"Nombre del Ingreso"),i(),n(8,"input",5),C("ngModelChange",function(p){return u(d),S(r.incomeData.name,p)||(r.incomeData.name=p),g(p)}),i()(),n(9,"div",3)(10,"label",6),o(11,"Monto"),i(),n(12,"input",7),C("ngModelChange",function(p){return u(d),S(r.incomeData.amount,p)||(r.incomeData.amount=p),g(p)}),i()(),n(13,"button",8),o(14," Actualizar Ingreso "),i()()()}if(e&2){let d=V(4);s(8),I("ngModel",r.incomeData.name),s(4),I("ngModel",r.incomeData.amount),s(),m("disabled",!d.valid)}},dependencies:[j,F,U,O,k,W,R,P]})};var X=class a{expenseData;setExpenseData(t){this.expenseData=t}getExpenseData(){return this.expenseData}clearExpenseData(){this.expenseData=null}static \u0275fac=function(e){return new(e||a)};static \u0275prov=Ce({token:a,factory:a.\u0275fac,providedIn:"root"})};var pt=a=>["/budgets/daily-expenses/add",a];function mt(a,t){if(a&1){let e=E();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),_(11,"customCurrency"),i(),n(12,"td"),o(13),i(),n(14,"td"),o(15),i(),n(16,"td")(17,"button",5),b("click",function(){let d=u(e).$implicit,l=v();return g(l.editExpense(d))}),o(18," Editar "),i(),n(19,"button",6),b("click",function(){let d=u(e).$implicit,l=v();return g(l.deleteExpense(d))}),o(20," Eliminar "),i()()()}if(a&2){let e=t.$implicit;s(2),x(e.paymentDate),s(2),x(e.customName),s(2),x(e.expenseTypeName),s(2),x(e.expenseTypeCategory),s(2),x(D(11,7,e.amount)),s(3),x(e.paymentMethodName),s(2),x(e.detail)}}var ge=class a{constructor(t,e,r,d){this.route=t;this.budgetsService=e;this.dailyExpenseStateService=r;this.router=d}dailyExpenses=[];budgetId=null;ngOnInit(){this.budgetId=this.route.snapshot.paramMap.get("budgetId"),this.budgetId&&this.fetchDailyExpenses(this.budgetId)}fetchDailyExpenses(t){this.budgetsService.getDailyExpensesByBudget(t).subscribe({next:e=>{console.log("Gastos diarios obtenidos:",e),this.dailyExpenses=e},error:e=>console.error("Error al obtener gastos diarios",e)})}editExpense(t){this.dailyExpenseStateService.setExpenseData(t),this.router.navigate(["/budgets/daily-expenses/update",t.budgetId,t.expenseBudgetDetailId,t.dailyExpenseRecordId])}deleteExpense(t){confirm("\xBFEst\xE1s seguro de que deseas eliminar este gasto diario?")&&this.budgetsService.deleteDailyExpense(t.budgetId,t.expenseBudgetDetailId,t.dailyExpenseRecordId).subscribe({next:()=>{alert("Gasto diario eliminado con \xE9xito."),this.fetchDailyExpenses(t.budgetId)},error:e=>{console.error("Error al eliminar el gasto diario",e),alert("Ocurri\xF3 un error al eliminar el gasto diario.")}})}static \u0275fac=function(e){return new(e||a)(c(B),c(y),c(X),c(G))};static \u0275cmp=h({type:a,selectors:[["app-daily-expenses-list"]],decls:27,vars:4,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-end","mb-3"],[1,"btn","btn-success",3,"routerLink"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2"),o(2,"Gastos Diarios"),i(),n(3,"div",1)(4,"button",2),o(5," + Agregar Gasto Diario "),i()(),n(6,"table",3)(7,"thead")(8,"tr")(9,"th"),o(10,"Fecha de Pago"),i(),n(11,"th"),o(12,"Nombre"),i(),n(13,"th"),o(14,"Tipo"),i(),n(15,"th"),o(16,"Categoria"),i(),n(17,"th"),o(18,"Valor"),i(),n(19,"th"),o(20,"M\xE9todo de Pago"),i(),n(21,"th"),o(22,"Detalle"),i(),n(23,"th"),o(24,"Acciones"),i()()(),n(25,"tbody"),f(26,mt,21,9,"tr",4),i()()()),e&2&&(s(4),m("routerLink",M(2,pt,r.budgetId)),s(22),m("ngForOf",r.dailyExpenses))},dependencies:[T,q,z]})};function lt(a,t){if(a&1&&(n(0,"option",16),o(1),i()),a&2){let e=t.$implicit;m("value",e.expenseBudgetDetailId),s(),te(" ",e.customName," (",e.expenseTypeName,") ")}}function ct(a,t){if(a&1&&(n(0,"option",16),o(1),i()),a&2){let e=t.$implicit;m("value",e.paymentMethodId),s(),ee(" ",e.name," ")}}var xe=class a{constructor(t,e,r,d,l){this.route=t;this.paymentMethodService=e;this.budgetsService=r;this.dailyExpenseStateService=d;this.router=l}budgetId=null;expenseBudgetDetailId=null;dailyExpenseRecordId=null;dailyExpenseData={expenseBudgetDetailId:0,paymentDate:"",amount:0,paymentMethodId:0,detail:""};paymentMethods=[];expenseDetails=[];ngOnInit(){this.budgetId=this.route.snapshot.paramMap.get("budgetId"),this.expenseBudgetDetailId=Number(this.route.snapshot.paramMap.get("expenseBudgetDetailId")),this.dailyExpenseRecordId=Number(this.route.snapshot.paramMap.get("dailyExpenseRecordId"));let t=this.dailyExpenseStateService.getExpenseData();t?(this.dailyExpenseData=Y({},t),console.log("Datos del gasto diario asignados:",this.dailyExpenseData)):console.error("No se recibi\xF3 el estado con los datos del gasto diario."),this.dailyExpenseStateService.clearExpenseData(),this.fetchPaymentMethods(),this.budgetId&&this.fetchExpenseDetails(this.budgetId)}fetchPaymentMethods(){this.paymentMethodService.getPaymentMethods().subscribe({next:t=>this.paymentMethods=t,error:t=>console.error("Error al obtener m\xE9todos de pago",t)})}fetchExpenseDetails(t){this.budgetsService.getExpensesByBudget(t).subscribe({next:e=>this.expenseDetails=e,error:e=>console.error("Error al obtener detalles del presupuesto",e)})}updateDailyExpense(){if(!this.budgetId||!this.expenseBudgetDetailId||!this.dailyExpenseRecordId)return;let t=Y({},this.dailyExpenseData);this.budgetsService.updateDailyExpense(this.budgetId,this.expenseBudgetDetailId,this.dailyExpenseRecordId,t).subscribe({next:()=>{alert("Gasto diario actualizado con \xE9xito"),this.router.navigate([`/budgets/daily-expenses/${this.budgetId}`])},error:e=>{console.error("Error al actualizar el gasto diario",e),alert("Ocurri\xF3 un error al actualizar el gasto diario")}})}static \u0275fac=function(e){return new(e||a)(c(B),c(we),c(y),c(X),c(G))};static \u0275cmp=h({type:a,selectors:[["app-update-daily-expense"]],decls:29,vars:8,consts:[["dailyExpenseForm","ngForm"],[1,"container","mt-4"],[3,"ngSubmit"],[1,"mb-3"],["for","expenseBudgetDetailId",1,"form-label"],["id","expenseBudgetDetailId","name","expenseBudgetDetailId","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","paymentDate",1,"form-label"],["type","date","id","paymentDate","name","paymentDate","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","amount",1,"form-label"],["type","number","id","amount","name","amount","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","paymentMethodId",1,"form-label"],["id","paymentMethodId","name","paymentMethodId","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","detail",1,"form-label"],["id","detail","name","detail","rows","3","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"value"]],template:function(e,r){if(e&1){let d=E();n(0,"div",1)(1,"h2"),o(2,"Actualizar Gasto Diario"),i(),n(3,"form",2,0),b("ngSubmit",function(){return u(d),g(r.updateDailyExpense())}),n(5,"div",3)(6,"label",4),o(7,"Tipo de Gasto Relacionado"),i(),n(8,"select",5),C("ngModelChange",function(p){return u(d),S(r.dailyExpenseData.expenseBudgetDetailId,p)||(r.dailyExpenseData.expenseBudgetDetailId=p),g(p)}),f(9,lt,2,3,"option",6),i()(),n(10,"div",3)(11,"label",7),o(12,"Fecha de Pago"),i(),n(13,"input",8),C("ngModelChange",function(p){return u(d),S(r.dailyExpenseData.paymentDate,p)||(r.dailyExpenseData.paymentDate=p),g(p)}),i()(),n(14,"div",3)(15,"label",9),o(16,"Monto"),i(),n(17,"input",10),C("ngModelChange",function(p){return u(d),S(r.dailyExpenseData.amount,p)||(r.dailyExpenseData.amount=p),g(p)}),i()(),n(18,"div",3)(19,"label",11),o(20,"M\xE9todo de Pago"),i(),n(21,"select",12),C("ngModelChange",function(p){return u(d),S(r.dailyExpenseData.paymentMethodId,p)||(r.dailyExpenseData.paymentMethodId=p),g(p)}),f(22,ct,2,2,"option",6),i()(),n(23,"div",3)(24,"label",13),o(25,"Detalle"),i(),n(26,"textarea",14),C("ngModelChange",function(p){return u(d),S(r.dailyExpenseData.detail,p)||(r.dailyExpenseData.detail=p),g(p)}),i()(),n(27,"button",15),o(28," Actualizar Gasto Diario "),i()()()}if(e&2){let d=V(4);s(8),I("ngModel",r.dailyExpenseData.expenseBudgetDetailId),s(),m("ngForOf",r.expenseDetails),s(4),I("ngModel",r.dailyExpenseData.paymentDate),s(4),I("ngModel",r.dailyExpenseData.amount),s(4),I("ngModel",r.dailyExpenseData.paymentMethodId),s(),m("ngForOf",r.paymentMethods),s(4),I("ngModel",r.dailyExpenseData.detail),s(),m("disabled",!d.valid)}},dependencies:[T,j,oe,re,F,U,ie,O,k,W,R,P]})};function gt(a,t){a&1&&(n(0,"div",2)(1,"p"),o(2,"Cargando datos..."),i()())}function xt(a,t){if(a&1&&(n(0,"div",3),K(1,"canvas",4),i()),a&2){let e=v();s(),m("data",e.chartData)("labels",e.chartData.labels)("options",e.chartOptions)("type",e.chartType)}}function ft(a,t){a&1&&(n(0,"div",2)(1,"p"),o(2,"No hay datos disponibles para mostrar."),i()())}var fe=class a{constructor(t,e){this.budgetsService=t;this.authService=e}chartOptions={responsive:!0,maintainAspectRatio:!1};chartType="line";chartData={labels:[],datasets:[]};isLoading=!0;userId="";ngOnInit(){this.userId=this.authService.getUserIdFromToken(),this.userId?this.fetchBudgetData():console.error("No se pudo obtener el usuario del token.","Error")}fetchBudgetData(){this.userId&&this.budgetsService.getBudgetsByUser(this.userId).subscribe(t=>{t.length>0?(this.chartData.labels=t.map(e=>`${e.month}/${e.year}`),this.chartData.datasets=[{data:t.map(e=>e.totalIncome),label:"Ingresos",borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!0},{data:t.map(e=>e.totalExpenses),label:"Gastos",borderColor:"rgba(255, 99, 132, 1)",backgroundColor:"rgba(255, 99, 132, 0.2)",fill:!0}]):console.error("No se recibieron datos del servidor."),this.isLoading=!1},t=>{console.error("Error al obtener los datos del servidor:",t),this.isLoading=!1})}static \u0275fac=function(e){return new(e||a)(c(y),c(J))};static \u0275cmp=h({type:a,selectors:[["app-income-expense-trends"]],decls:3,vars:3,consts:[["class","text-center",4,"ngIf"],["class","chart-container","style","display: block; height: 400px;",4,"ngIf"],[1,"text-center"],[1,"chart-container",2,"display","block","height","400px"],["baseChart","",3,"data","labels","options","type"]],template:function(e,r){e&1&&f(0,gt,3,0,"div",0)(1,xt,2,4,"div",1)(2,ft,3,0,"div",0),e&2&&(m("ngIf",r.isLoading),s(),m("ngIf",!r.isLoading&&r.chartData.datasets.length>0),s(),m("ngIf",!r.isLoading&&r.chartData.datasets.length===0))},dependencies:[L,se]})};function bt(a,t){a&1&&(n(0,"div",2)(1,"p"),o(2,"Cargando datos..."),i()())}function ht(a,t){if(a&1&&(n(0,"div",3),K(1,"canvas",4),i()),a&2){let e=v();s(),m("data",e.chartData)("labels",e.chartData.labels)("options",e.chartOptions)("type",e.chartType)}}function yt(a,t){a&1&&(n(0,"div",2)(1,"p"),o(2,"No hay datos disponibles para mostrar."),i()())}var be=class a{constructor(t,e){this.budgetsService=t;this.authService=e}chartOptions={responsive:!0,maintainAspectRatio:!1};chartType="bar";chartData={labels:[],datasets:[]};userId="";isLoading=!0;ngOnInit(){this.userId=this.authService.getUserIdFromToken(),this.userId?this.processData():console.error("No se pudo obtener el usuario del token.","Error")}processData(){this.userId&&this.budgetsService.getBudgetsByUser(this.userId).subscribe(t=>{t.length>0?(this.chartData.labels=t.map(e=>`${e.month}/${e.year}`),this.chartData.datasets=[{data:t.map(e=>e.nonBudgetedExpenses),label:"Gastos No Presupuestados",backgroundColor:"rgba(255, 159, 64, 0.6)"}]):console.error("No se recibieron datos del servidor."),this.isLoading=!1},t=>{console.error("Error al obtener los datos del servidor:",t),this.isLoading=!1})}static \u0275fac=function(e){return new(e||a)(c(y),c(J))};static \u0275cmp=h({type:a,selectors:[["app-non-budgeted-expenses"]],decls:3,vars:3,consts:[["class","text-center",4,"ngIf"],["class","chart-container","style","display: block; height: 400px;",4,"ngIf"],[1,"text-center"],[1,"chart-container",2,"display","block","height","400px"],["baseChart","",3,"data","labels","options","type"]],template:function(e,r){e&1&&f(0,bt,3,0,"div",0)(1,ht,2,4,"div",1)(2,yt,3,0,"div",0),e&2&&(m("ngIf",r.isLoading),s(),m("ngIf",!r.isLoading&&r.chartData.datasets.length>0),s(),m("ngIf",!r.isLoading&&r.chartData.datasets.length===0))},dependencies:[L,se]})};var vt=[{path:"",component:de},{path:"create",component:Ne},{path:"clone/:budgetId",component:Ae},{path:"update/:budgetId",component:Ve},{path:"expenses/:budgetId",component:pe},{path:"expenses/add/:budgetId",component:me},{path:"expenses/update/:budgetId/:expenseId",component:le},{path:"incomes/:budgetId",component:ce},{path:"incomes/add/:budgetId",component:Le},{path:"incomes/update/:budgetId/:incomeId",component:ue},{path:"daily-expenses/:budgetId",component:ge},{path:"daily-expenses/add/:budgetId",component:Fe},{path:"daily-expenses/update/:budgetId/:expenseBudgetDetailId/:dailyExpenseRecordId",component:xe},{path:"charts/plan-vs-executed",component:ke},{path:"charts/expense-distribution",component:Pe},{path:"charts/income-expense-trends",component:fe},{path:"charts/non-budgeted-expenses",component:be},{path:"charts/payment-status",component:Re}],he=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=$({type:a});static \u0275inj=Z({imports:[ye.forChild(vt),ye]})};var Ge=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=$({type:a});static \u0275inj=Z({imports:[Te,he,Be,Me,je,Oe]})};export{Ge as BudgetsModule};
