import{a as le,b as w}from"./chunk-2AIR5MD6.js";import{a as ae}from"./chunk-VJMH5IEE.js";import{$ as R,D as m,E as k,Ga as Q,Ha as X,I as g,Ia as Z,Ja as $,K as y,Ka as ee,La as te,Ma as ne,O as o,P as t,Q as _,R as z,S as q,T as b,Ua as ie,V as x,W as u,Wa as oe,X as j,Y as r,Ya as se,Z as C,Za as re,_ as I,ba as f,ca as E,da as h,db as W,eb as me,fb as ce,g as N,ha as v,ia as M,j as S,k as A,la as D,m as Y,o as L,p as T,ra as G,sa as H,t as d,u as p,ua as J,xa as U,za as K}from"./chunk-TLOM4RKB.js";var B=class s{constructor(n){this.http=n}apiUrl="https://easy-finances-app-63cef07822fc.herokuapp.com/api/economic-analysis";analyzeEconomicCapacity(n){return this.http.post(this.apiUrl,n)}static \u0275fac=function(e){return new(e||s)(Y(K))};static \u0275prov=S({token:s,factory:s.\u0275fac,providedIn:"root"})};var V=class s{expensesSubject=new N([]);expenses$=this.expensesSubject.asObservable();getExpenses(){return this.expensesSubject.getValue()}addExpense(n){let e=[...this.getExpenses(),n];this.expensesSubject.next(e)}editExpense(n){let e=this.getExpenses().map(i=>i.expenseTypeId===n.expenseTypeId?n:i);this.expensesSubject.next(e)}removeExpense(n){let e=this.getExpenses().filter(i=>i.expenseTypeId!==n);this.expensesSubject.next(e)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=S({token:s,factory:s.\u0275fac,providedIn:"root"})};function ye(s,n){s&1&&(o(0,"div",57),r(1," Ingresos mensuales son obligatorios. "),t())}function xe(s,n){if(s&1){let e=b();o(0,"input",58),h("ngModelChange",function(a){d(e);let l=u();return E(l.christmasBonusAmount,a)||(l.christmasBonusAmount=a),p(a)}),t()}if(s&2){let e=u();f("ngModel",e.christmasBonusAmount)}}function fe(s,n){if(s&1){let e=b();o(0,"input",59),h("ngModelChange",function(a){d(e);let l=u();return E(l.midYearBonusAmount,a)||(l.midYearBonusAmount=a),p(a)}),t()}if(s&2){let e=u();f("ngModel",e.midYearBonusAmount)}}function Ee(s,n){if(s&1){let e=b();o(0,"div",63),x("click",function(){let a=d(e).$implicit,l=u(2);return p(l.selectExpense(a))})("keydown.enter",function(){let a=d(e).$implicit,l=u(2);return p(l.selectExpense(a))}),o(1,"span"),r(2),t(),_(3,"i",64),t()}if(s&2){let e=n.$implicit;m(2),C(e.name)}}function he(s,n){if(s&1&&(o(0,"div")(1,"h6",60),r(2),t(),o(3,"div",61),g(4,Ee,4,1,"div",62),t()()),s&2){let e=n.$implicit;m(2),C(e.key),m(2),y("ngForOf",e.value)}}function _e(s,n){if(s&1&&(o(0,"div",68),r(1),t()),s&2){let e=u(2);m(),C(e.errorMessage)}}function be(s,n){if(s&1){let e=b();o(0,"div",65)(1,"div",66)(2,"h5"),r(3),t(),o(4,"input",67),h("ngModelChange",function(a){d(e);let l=u();return E(l.amountInput,a)||(l.amountInput=a),p(a)}),t(),o(5,"div",52)(6,"button",53),x("click",function(){d(e);let a=u();return p(a.cancelAmountInput())}),r(7,"Cancelar"),t(),o(8,"button",54),x("click",function(){d(e);let a=u();return p(a.confirmAmount())}),r(9,"Confirmar"),t()(),g(10,_e,2,1,"div",55),t()()}if(s&2){let e=u();m(3),R("Ingresar Monto para: ",e.selectedExpense==null?null:e.selectedExpense.name," - ",e.selectedExpense==null?null:e.selectedExpense.category,""),m(),f("ngModel",e.amountInput),m(6),y("ngIf",e.errorMessage)}}function Ce(s,n){if(s&1){let e=b();o(0,"tr")(1,"td"),r(2),t(),o(3,"td"),r(4),v(5,"customCurrency"),t(),o(6,"td")(7,"button",69),x("click",function(){let a=d(e).$implicit,l=u();return p(l.editExpense(a))}),_(8,"i",70),t(),o(9,"button",69),x("click",function(){let a=d(e).$implicit,l=u();return p(l.removeExpense(a.expenseTypeId))}),_(10,"i",71),t()()()}if(s&2){let e=n.$implicit;m(2),C(e.expenseTypeNameAndCategory),m(2),C(M(5,2,e.amount))}}function ve(s,n){if(s&1&&(o(0,"div",68),r(1),t()),s&2){let e=u();m(),C(e.errorMessage)}}function Me(s,n){if(s&1&&(z(0),o(1,"p")(2,"strong"),r(3,"Monto Sugerido para Pago:"),t(),r(4),v(5,"customCurrency"),t(),o(6,"p",75),r(7," Aunque el monto sugerido puede parecer bajo, realizar peque\xF1os abonos a capital, incluso de $20.000 pesos, impactar\xE1 significativamente en la reducci\xF3n del tiempo y de los intereses de tu cr\xE9dito. "),t(),q()),s&2){let e=u(2);m(4),I(" ",M(5,1,e.analysisResult.suggestedPaymentAmount),"")}}function Ie(s,n){s&1&&(o(0,"div",76)(1,"strong"),r(2,"Atenci\xF3n:"),t(),r(3," Tus gastos actuales superan tus ingresos, lo que hace dif\xEDcil generar un monto sugerido para pago. Considera reducir gastos para mejorar tu capacidad de pago. "),t())}function we(s,n){if(s&1&&(o(0,"div",72)(1,"h4",44),r(2,"Resultado del An\xE1lisis"),t(),o(3,"div",73)(4,"p")(5,"strong"),r(6,"Ingresos Mensuales:"),t(),r(7),v(8,"customCurrency"),t(),o(9,"p")(10,"strong"),r(11,"Ingresos Adicionales:"),t(),r(12),v(13,"customCurrency"),t(),o(14,"p")(15,"strong"),r(16,"Gastos Totales:"),t(),r(17),v(18,"customCurrency"),t(),g(19,Me,8,3,"ng-container",74)(20,Ie,4,0,"ng-template",null,1,D),t()()),s&2){let e=j(21),i=u();m(7),I(" ",M(8,5,i.analysisResult.monthlyIncome),""),m(5),I(" ",M(13,7,i.analysisResult.additionalIncome),""),m(5),I(" ",M(18,9,i.analysisResult.totalExpenses),""),m(2),y("ngIf",i.analysisResult.suggestedPaymentAmount>=0)("ngIfElse",e)}}var P=class s{constructor(n,e,i){this.economicAnalysisService=n;this.expenseTypeService=e;this.sharedExpenseService=i}monthlyIncome=0;additionalIncome=0;receivesChristmasBonus=!1;receivesMidYearBonus=!1;christmasBonusAmount=0;midYearBonusAmount=0;expenses=[];analysisResult;expenseTypes=[];groupedExpenseTypes={};filteredExpenseTypes={};searchTerm="";selectedExpense;amountInput=0;showAmountInput=!1;errorMessage="";ngOnInit(){this.loadExpenseTypes(),this.expenses=this.sharedExpenseService.getExpenses()}loadExpenseTypes(){this.expenseTypeService.getExpenseTypes().subscribe({next:n=>{this.expenseTypes=n,this.groupExpenseTypes(),this.filterExpenses()}})}groupExpenseTypes(){this.groupedExpenseTypes=this.expenseTypes.reduce((n,e)=>(n[e.category]||(n[e.category]=[]),n[e.category].push(e),n),{})}filterExpenses(){let n=this.searchTerm.toLowerCase(),e={};Object.keys(this.groupedExpenseTypes).forEach(i=>{let a=this.groupedExpenseTypes[i].filter(l=>!this.expenses.some(pe=>pe.expenseTypeId===l.id)&&(l.name.toLowerCase().includes(n)||l.category.toLowerCase().includes(n)));a.length>0&&(e[i]=a)}),this.filteredExpenseTypes=e}openExpenseModal(){let n=document.getElementById("expenseModal");n&&new w(n).show()}closeModal(){let n=document.getElementById("expenseModal");n&&w.getInstance(n)?.hide(),this.resetSelection()}selectExpense(n){this.selectedExpense=n,this.amountInput=0,this.showAmountInput=!0,this.errorMessage=""}confirmAmount(){if(this.amountInput>0){let n={expenseTypeId:this.selectedExpense.id,expenseTypeNameAndCategory:`${this.selectedExpense.name} - ${this.selectedExpense.category}`,amount:this.amountInput};this.addExpense(n),this.showAmountInput=!1,this.amountInput=0,this.filterExpenses(),this.closeModal()}else this.errorMessage="Por favor, ingrese un monto v\xE1lido."}resetSelection(){this.selectedExpense=void 0,this.amountInput=0,this.showAmountInput=!1,this.errorMessage=""}cancelAmountInput(){this.resetSelection()}addExpense(n){this.sharedExpenseService.addExpense(n),this.expenses=this.sharedExpenseService.getExpenses(),this.filterExpenses()}editExpense(n){this.selectedExpense=this.expenseTypes.find(i=>i.id===n.expenseTypeId),this.amountInput=n.amount,this.errorMessage="";let e=document.getElementById("editExpenseModal");e&&new w(e).show()}confirmEditAmount(){if(this.amountInput>0){let n=this.expenses.find(e=>e.expenseTypeId===this.selectedExpense.id);n&&(n.amount=this.amountInput,this.sharedExpenseService.editExpense(n),this.filterExpenses(),this.closeEditModal())}else this.errorMessage="Por favor, ingrese un monto v\xE1lido."}closeEditModal(){let n=document.getElementById("editExpenseModal");n&&w.getInstance(n)?.hide(),this.resetSelection()}cancelEdit(){this.closeEditModal()}removeExpense(n){this.sharedExpenseService.removeExpense(n),this.expenses=this.sharedExpenseService.getExpenses(),this.filterExpenses()}analyzeEconomicCapacity(){if(this.expenses.length===0)return;let n=this.expenses.map(i=>({expenseTypeId:i.expenseTypeId,amount:i.amount})),e={userId:ae(),monthlyIncome:this.monthlyIncome,additionalIncome:this.additionalIncome,expenses:n,receivesChristmasBonus:this.receivesChristmasBonus,receivesMidYearBonus:this.receivesMidYearBonus,christmasBonusAmount:this.receivesChristmasBonus?this.christmasBonusAmount:0,midYearBonusAmount:this.receivesMidYearBonus?this.midYearBonusAmount:0};this.economicAnalysisService.analyzeEconomicCapacity(e).subscribe({next:i=>{this.analysisResult=i}})}static \u0275fac=function(e){return new(e||s)(k(B),k(le),k(V))};static \u0275cmp=L({type:s,selectors:[["app-economic-analysis-form"]],decls:101,vars:18,consts:[["monthlyIncomeModel","ngModel"],["negativeAmountMessage",""],[1,"container","mt-3"],[1,"intro-section","bg-light","text-center","p-4","rounded","shadow-sm","mb-4"],[1,"text-primary","mb-3"],[1,"lead","text-muted"],[1,"expenses-guide-section","text-white","text-center","p-3","rounded","shadow-sm","mb-4"],[1,"mb-0"],["autocomplete","off",3,"ngSubmit"],[1,"d-flex","justify-content-center"],[1,"w-auto","p-3"],[1,"row","mb-3"],[1,"col"],["for","monthlyIncome",1,"form-label"],["type","text","id","monthlyIncome","name","monthlyIncome","currencyMask","","placeholder","Ej: 5.000.000","required","","autocomplete","off",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger",4,"ngIf"],["for","additionalIncome",1,"form-label"],["type","text","id","additionalIncome","name","additionalIncome","currencyMask","","placeholder","Ej: 500.000",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check"],["type","checkbox","name","receivesChristmasBonus","id","christmasBonus","autocomplete","off",1,"form-check-input",3,"ngModelChange","ngModel"],["for","christmasBonus",1,"form-check-label"],["type","text","name","christmasBonusAmount","class","form-control mt-2","currencyMask","","placeholder","Cantidad Prima de Navidad",3,"ngModel","ngModelChange",4,"ngIf"],["type","checkbox","name","receivesMidYearBonus","id","midYearBonus","autocomplete","off",1,"form-check-input",3,"ngModelChange","ngModel"],["for","midYearBonus",1,"form-check-label"],["type","text","name","midYearBonusAmount","class","form-control mt-2","currencyMask","","placeholder","Cantidad Prima de Junio",3,"ngModel","ngModelChange",4,"ngIf"],[1,"text-center","mb-3"],["type","button",1,"btn","btn-primary",3,"click"],["id","expenseModal","tabindex","-1","aria-labelledby","expenseModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],["id","expenseModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"input-group","mb-3"],["type","text","placeholder","Buscar por nombre o categor\xEDa","name","searchTerm",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"input-group-text"],[1,"bi","bi-search"],[1,"expense-list-container","mb-3",2,"max-height","300px","overflow-y","auto"],[4,"ngFor","ngForOf"],["class","overlay",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"table","table-bordered","mt-3"],[1,"text-center"],["type","submit",1,"btn","btn-primary"],["id","editExpenseModal","tabindex","-1","aria-labelledby","editExpenseModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-header","bg-warning","text-dark"],["id","editExpenseModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],["type","text","name","editAmountInput","currencyMask","","placeholder","Ingrese el nuevo monto",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","mt-2"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["class","text-danger mt-2",4,"ngIf"],["class","analysis-result mt-5",4,"ngIf"],[1,"text-danger"],["type","text","name","christmasBonusAmount","currencyMask","","placeholder","Cantidad Prima de Navidad",1,"form-control","mt-2",3,"ngModelChange","ngModel"],["type","text","name","midYearBonusAmount","currencyMask","","placeholder","Cantidad Prima de Junio",1,"form-control","mt-2",3,"ngModelChange","ngModel"],[1,"text-secondary","category-title"],[1,"list-group"],["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"click","keydown.enter",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",3,"click","keydown.enter"],[1,"bi","bi-plus-circle","text-primary"],[1,"overlay"],[1,"amount-input-section"],["type","text","name","amountInput","currencyMask","","placeholder","Ingrese el monto",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-danger","mt-2"],["type","button",1,"btn-link",3,"click"],[1,"bi","bi-pencil-square","edit-icon"],[1,"bi","bi-trash","delete-icon"],[1,"analysis-result","mt-5"],[1,"bg-light","p-4","rounded","shadow-sm","mb-4"],[4,"ngIf","ngIfElse"],[1,"text-success"],[1,"alert","alert-warning","mt-3"]],template:function(e,i){if(e&1){let a=b();o(0,"div",2)(1,"h5"),r(2,"An\xE1lisis de Capacidad de Pago"),t(),_(3,"hr"),o(4,"div",3)(5,"h2",4),r(6,"Analiza tu Capacidad de Pago"),t(),o(7,"p",5),r(8," Conocer tu capacidad de pago es clave para gestionar tus finanzas. Introduce tus ingresos, gastos y descubre cu\xE1nto puedes destinar para el pago de tu cr\xE9dito. "),t()(),o(9,"div",6)(10,"p",7)(11,"strong"),r(12,"Consejo:"),t(),r(13," Puedes ser tan espec\xEDfico como desees al agregar tus gastos. Detalla cada tipo de gasto o agr\xFApalos en categor\xEDas m\xE1s amplias seg\xFAn prefieras. La idea es ayudarte a capturar todos los gastos y no olvidar ninguno. "),t()(),o(14,"form",8),x("ngSubmit",function(){return d(a),p(i.analyzeEconomicCapacity())}),o(15,"div",9)(16,"div",10)(17,"h6"),r(18,"Ingresos"),t(),_(19,"hr"),o(20,"div",11)(21,"div",12)(22,"label",13),r(23,"Mensuales"),t(),o(24,"input",14,0),h("ngModelChange",function(c){return d(a),E(i.monthlyIncome,c)||(i.monthlyIncome=c),p(c)}),t(),g(26,ye,2,0,"div",15),t(),o(27,"div",12)(28,"label",16),r(29,"Otros"),t(),o(30,"input",17),h("ngModelChange",function(c){return d(a),E(i.additionalIncome,c)||(i.additionalIncome=c),p(c)}),t()()(),o(31,"div",11)(32,"div",12)(33,"div",18)(34,"input",19),h("ngModelChange",function(c){return d(a),E(i.receivesChristmasBonus,c)||(i.receivesChristmasBonus=c),p(c)}),t(),o(35,"label",20),r(36,"Recibo Prima de Navidad"),t()(),g(37,xe,1,1,"input",21),t(),o(38,"div",12)(39,"div",18)(40,"input",22),h("ngModelChange",function(c){return d(a),E(i.receivesMidYearBonus,c)||(i.receivesMidYearBonus=c),p(c)}),t(),o(41,"label",23),r(42,"Recibo Prima de Junio"),t()(),g(43,fe,1,1,"input",24),t()(),o(44,"h6"),r(45,"Gastos"),t(),_(46,"hr"),o(47,"div",25)(48,"button",26),x("click",function(){return d(a),p(i.openExpenseModal())}),r(49,"Agregar Gastos"),t()(),o(50,"div",27)(51,"div",28)(52,"div",29)(53,"div",30)(54,"h5",31),r(55,"Seleccionar Tipos de Gastos"),t(),_(56,"button",32),t(),o(57,"div",33)(58,"div",34)(59,"input",35),h("ngModelChange",function(c){return d(a),E(i.searchTerm,c)||(i.searchTerm=c),p(c)}),x("input",function(){return d(a),p(i.filterExpenses())}),t(),o(60,"span",36),_(61,"i",37),t()(),o(62,"div",38),g(63,he,5,2,"div",39),v(64,"keyvalue"),t(),g(65,be,11,4,"div",40),t(),o(66,"div",41)(67,"button",42),r(68,"Cerrar"),t()()()()(),o(69,"table",43)(70,"thead")(71,"tr")(72,"th"),r(73,"Tipo de Gasto"),t(),o(74,"th"),r(75,"Monto"),t(),o(76,"th"),r(77,"Acci\xF3n"),t()()(),o(78,"tbody"),g(79,Ce,11,4,"tr",39),t()(),o(80,"div",44)(81,"button",45),r(82,"Analizar Capacidad de Pago"),t()()()()(),o(83,"div",46)(84,"div",47)(85,"div",29)(86,"div",48)(87,"h5",49),r(88,"Editar Monto del Gasto"),t(),o(89,"button",50),x("click",function(){return d(a),p(i.cancelEdit())}),t()(),o(90,"div",33)(91,"h6"),r(92),t(),o(93,"input",51),h("ngModelChange",function(c){return d(a),E(i.amountInput,c)||(i.amountInput=c),p(c)}),t(),o(94,"div",52)(95,"button",53),x("click",function(){return d(a),p(i.cancelEdit())}),r(96,"Cancelar"),t(),o(97,"button",54),x("click",function(){return d(a),p(i.confirmEditAmount())}),r(98,"Confirmar"),t()(),g(99,ve,2,1,"div",55),t()()()(),g(100,we,22,11,"div",56),t()}if(e&2){let a=j(25);m(24),f("ngModel",i.monthlyIncome),m(2),y("ngIf",a.invalid&&(a.dirty||a.touched)),m(4),f("ngModel",i.additionalIncome),m(4),f("ngModel",i.receivesChristmasBonus),m(3),y("ngIf",i.receivesChristmasBonus),m(3),f("ngModel",i.receivesMidYearBonus),m(3),y("ngIf",i.receivesMidYearBonus),m(16),f("ngModel",i.searchTerm),m(4),y("ngForOf",M(64,16,i.filteredExpenseTypes)),m(2),y("ngIf",i.showAmountInput),m(14),y("ngForOf",i.expenses),m(13),R("Editar Monto para: ",i.selectedExpense==null?null:i.selectedExpense.name," - ",i.selectedExpense==null?null:i.selectedExpense.category,""),m(),f("ngModel",i.amountInput),m(6),y("ngIf",i.errorMessage),m(),y("ngIf",i.analysisResult)}},dependencies:[G,H,ne,X,Q,Z,$,ie,te,ee,se,J,me],styles:[".container[_ngcontent-%COMP%]{max-width:80%;margin:0 auto}h5[_ngcontent-%COMP%]{font-weight:700;margin-bottom:20px}hr[_ngcontent-%COMP%]{border-top:2px solid #dee2e6}.intro-section[_ngcontent-%COMP%]{background-color:#f0f4fa;border-left:5px solid #1e3a8a;color:#555;padding:20px;border-radius:8px;box-shadow:0 4px 6px #0000001a}.expenses-guide-section[_ngcontent-%COMP%]{background-color:#1a5384;padding:15px;border-radius:8px;margin-bottom:20px}button[type=submit][_ngcontent-%COMP%]{width:100%;padding:10px;font-size:1.2rem;transition:background-color .3s ease}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#e64a19}.table[_ngcontent-%COMP%]{margin-top:15px}.edit-icon[_ngcontent-%COMP%]{color:#007bff}.delete-icon[_ngcontent-%COMP%]{color:#dc3545}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1050}.amount-input-section[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0003;z-index:1060}.btn-link[_ngcontent-%COMP%]{border:none;background:none;padding:0;cursor:pointer}.btn-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.modal-content[_ngcontent-%COMP%]{background:#ffffffe6;box-shadow:0 8px 16px #0003}.modal-header[_ngcontent-%COMP%]{background-color:#1e3a8a;color:#fff}#editExpenseModal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.category-title[_ngcontent-%COMP%]{margin-top:1em}"]})};var Se=[{path:"",component:P},{path:"**",redirectTo:"economic-analysis"}],O=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=T({type:s});static \u0275inj=A({imports:[W.forChild(Se),W]})};var de=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=T({type:s});static \u0275inj=A({imports:[U,O,oe,re,ce]})};export{de as a};
